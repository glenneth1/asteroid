<!DOCTYPE html>
<html lang="en">
<head>
  <title data-text="title">Asteroid Radio - User Profile</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="/asteroid/static/asteroid.css">
  <script src="/asteroid/static/js/auth-ui.js"></script>
  <script src="/asteroid/static/js/profile.js"></script>
</head>
<body>
  <div class="container">
    <h1>ğŸ‘¤ USER PROFILE</h1>
    <div class="nav">
      <a href="/asteroid">Home</a>
      <a href="/asteroid/player">Player</a>
      <a href="/asteroid/admin" data-show-if-admin>Admin</a>
      <a href="/asteroid/logout" class="btn-logout">Logout</a>
    </div>

    <!-- User Profile Header -->
    <div class="admin-section">
        <h2>ğŸ§ User Profile</h2>
        <div class="profile-header">
          <div class="avatar-section">
            <div class="avatar-container" id="avatar-container">
              <img id="user-avatar" src="/asteroid/static/icons/default-avatar.svg" alt="User Avatar" class="avatar-image">
              <div class="avatar-overlay" onclick="document.getElementById('avatar-input').click()">
                <span>Change</span>
              </div>
            </div>
            <input type="file" id="avatar-input" accept="image/*" style="display: none" onchange="uploadAvatar(this)">
          </div>
          <div class="profile-info">
            <div class="info-group">
              <span class="info-label">Username:</span>
              <span class="info-value" data-text="username">user</span>
            </div>
            <div class="info-group">
              <span class="info-label">Role:</span>
              <span class="info-value" data-text="user-role">listener</span>
            </div>
            <div class="info-group">
              <span class="info-label">Member Since:</span>
              <span class="info-value" data-text="join-date">2024-01-01</span>
            </div>
            <div class="info-group">
              <span class="info-label">Last Active:</span>
              <span class="info-value" data-text="last-active">Today</span>
            </div>
          </div>
        </div>
      </div>

    <!-- Listening Statistics -->
    <div class="admin-section">
        <h2>ğŸ“Š Listening Statistics</h2>
        <div class="admin-grid">
          <div class="status-card">
            <h3>Total Listen Time</h3>
            <p class="stat-number" data-text="total-listen-time">0h 0m</p>
          </div>
          <div class="status-card">
            <h3>Tracks Played</h3>
            <p class="stat-number" data-text="tracks-played">0</p>
          </div>
          <div class="status-card">
            <h3>Sessions</h3>
            <p class="stat-number" data-text="session-count">0</p>
          </div>
          <div class="status-card">
            <h3>Favorite Genre</h3>
            <p class="stat-text" data-text="favorite-genre">Unknown</p>
          </div>
        </div>
      </div>

    <!-- Favorite Tracks -->
    <div class="admin-section">
        <h2>â¤ï¸ Favorite Tracks</h2>
        <div class="favorites-list" id="favorites-list">
          <p class="loading-message">Loading favorites...</p>
        </div>
        <div class="profile-actions">
          <button class="btn btn-secondary" onclick="loadMoreFavorites()">Load More</button>
        </div>
      </div>

    <!-- Top Artists -->
    <div class="admin-section">
        <h2>ğŸ¤ Top Artists</h2>
        <div class="artist-stats">
          <div class="artist-item">
            <span class="artist-name" data-text="top-artist-1">Unknown Artist</span>
            <span class="artist-plays" data-text="top-artist-1-plays">0 plays</span>
          </div>
          <div class="artist-item">
            <span class="artist-name" data-text="top-artist-2"></span>
            <span class="artist-plays" data-text="top-artist-2-plays"></span>
          </div>
          <div class="artist-item">
            <span class="artist-name" data-text="top-artist-3"></span>
            <span class="artist-plays" data-text="top-artist-3-plays"></span>
          </div>
          <div class="artist-item">
            <span class="artist-name" data-text="top-artist-4"></span>
            <span class="artist-plays" data-text="top-artist-4-plays"></span>
          </div>
          <div class="artist-item">
            <span class="artist-name" data-text="top-artist-5"></span>
            <span class="artist-plays" data-text="top-artist-5-plays"></span>
          </div>
        </div>
      </div>

    <!-- Listening Activity Chart -->
    <div class="admin-section">
        <h2>ğŸ“ˆ Listening Activity</h2>
        <div class="activity-chart">
          <p>Tracks played over the last 30 days</p>
          <div class="chart-container" id="activity-chart">
            <p class="loading-message">Loading activity data...</p>
          </div>
          <p class="chart-note" id="activity-total">Total: 0 tracks</p>
        </div>
      </div>

    <!-- Profile Actions -->
    <div class="admin-section">
        <h2>âš™ï¸ Profile Settings</h2>
        
        <!-- Change Password Form -->
        <div class="form-section">
          <h3>ğŸ”’ Change Password</h3>
          <form id="change-password-form" onsubmit="return changePassword(event)">
            <div class="form-group">
              <label for="current-password">Current Password:</label>
              <input type="password" id="current-password" name="current-password" required minlength="8">
            </div>
            <div class="form-group">
              <label for="new-password">New Password:</label>
              <input type="password" id="new-password" name="new-password" required minlength="8">
            </div>
            <div class="form-group">
              <label for="confirm-password">Confirm New Password:</label>
              <input type="password" id="confirm-password" name="confirm-password" required minlength="8">
            </div>
            <div id="password-message" class="message"></div>
            <button type="submit" class="btn btn-primary">Change Password</button>
          </form>
        </div>
        
        <div class="profile-actions">
          <button class="btn btn-primary" onclick="editProfile()">âœï¸ Edit Profile</button>
          <button class="btn btn-secondary" onclick="exportListeningData()">ğŸ“Š Export Data</button>
          <button class="btn btn-secondary" onclick="clearListeningHistory()">ğŸ—‘ï¸ Clear History</button>
        </div>
      </div>
  </div>

  <!-- Initialization handled by profile.js -->
</body>
</html>
